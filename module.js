/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/data","@grafana/ui","rxjs","@grafana/runtime"],(function(e,t,n,r,o){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=57)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){var r=n(7),o=n(31),i=n(32),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):i(e)}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r=n(8).Symbol;e.exports=r},function(e,t,n){var r=n(12),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t){e.exports=o},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(4),o=n(5);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(30))},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(11),o=n(15);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(21),o=n(13),i=n(38),a=n(39),u=Object.prototype,c=u.hasOwnProperty,s=r((function(e,t){e=Object(e);var n=-1,r=t.length,s=r>2?t[2]:void 0;for(s&&i(t[0],t[1],s)&&(r=1);++n<r;)for(var l=t[n],f=a(l),p=-1,y=f.length;++p<y;){var d=f[p],m=e[d];(void 0===m||o(m,u[d])&&!c.call(e,d))&&(e[d]=l[d])}return e}));e.exports=s},function(e,t,n){var r=n(53),o=0;e.exports=function(e){var t=++o;return r(e)+t}},function(e,t,n){var r=n(10),o=n(22),i=n(24);e.exports=function(e,t){return i(o(e,t,r),e+"")}},function(e,t,n){var r=n(23),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,u=o(i.length-t,0),c=Array(u);++a<u;)c[a]=i[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=i[a];return s[t]=n(c),r(e,this,s)}}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(25),o=n(37)(r);e.exports=o},function(e,t,n){var r=n(26),o=n(27),i=n(10),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=a},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var r=n(28),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var r=n(29),o=n(36);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(11),o=n(33),i=n(5),a=n(35),u=/^\[object .+?Constructor\]$/,c=Function.prototype,s=Object.prototype,l=c.toString,f=s.hasOwnProperty,p=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?p:u).test(a(e))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(7),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,u=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var o=a.call(e);return r&&(t?e[u]=n:delete e[u]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,o=n(34),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!i&&i in e}},function(e,t,n){var r=n(8)["__core-js_shared__"];e.exports=r},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var o=n(),i=16-(o-r);if(r=o,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var r=n(13),o=n(14),i=n(16),a=n(5);e.exports=function(e,t,n){if(!a(n))return!1;var u=typeof t;return!!("number"==u?o(n)&&i(t,n.length):"string"==u&&t in n)&&r(n[t],e)}},function(e,t,n){var r=n(40),o=n(50),i=n(14);e.exports=function(e){return i(e)?r(e,!0):o(e)}},function(e,t,n){var r=n(41),o=n(42),i=n(17),a=n(44),u=n(16),c=n(46),s=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),l=!n&&o(e),f=!n&&!l&&a(e),p=!n&&!l&&!f&&c(e),y=n||l||f||p,d=y?r(e.length,String):[],m=d.length;for(var v in e)!t&&!s.call(e,v)||y&&("length"==v||f&&("offset"==v||"parent"==v)||p&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||u(v,m))||d.push(v);return d}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(43),o=n(6),i=Object.prototype,a=i.hasOwnProperty,u=i.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return o(e)&&a.call(e,"callee")&&!u.call(e,"callee")};e.exports=c},function(e,t,n){var r=n(4),o=n(6);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},function(e,t,n){(function(e){var r=n(8),o=n(45),i=t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,u=a&&a.exports===i?r.Buffer:void 0,c=(u?u.isBuffer:void 0)||o;e.exports=c}).call(this,n(18)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(47),o=n(48),i=n(49),a=i&&i.isTypedArray,u=a?o(a):r;e.exports=u},function(e,t,n){var r=n(4),o=n(15),i=n(6),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(12),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o&&r.process,u=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=u}).call(this,n(18)(e))},function(e,t,n){var r=n(5),o=n(51),i=n(52),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var u in e)("constructor"!=u||!t&&a.call(e,u))&&n.push(u);return n}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){var r=n(54);e.exports=function(e){return null==e?"":r(e)}},function(e,t,n){var r=n(7),o=n(55),i=n(17),a=n(56),u=r?r.prototype:void 0,c=u?u.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(a(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){var r=n(4),o=n(6);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},function(e,t,n){"use strict";n.r(t);var r=n(1);function o(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))}Object.create;Object.create;var i,a,u=n(9);!function(e){e.ListDimensionKeys="ListDimensionKeys",e.ListDimensionValues="ListDimensionValues",e.ListMetrics="ListMetrics",e.GetMetricValue="GetMetricValue",e.GetMetricHistory="GetMetricHistory",e.GetMetricAggregate="GetMetricAggregate"}(i||(i={})),function(e){e.AVERAGE="AVERAGE",e.MAXIMUM="MAX",e.MINIMUM="MIN",e.COUNT="COUNT"}(a||(a={}));var c,s={dimensions:[]};!function(e){e.metric="metric",e.dimensionValue="dimension Value"}(c||(c={}));var l=function(e){return e.split(";").map((function(e){return e.split("=")})).filter((function(e){return 2===e.length})).map((function(e){return{id:e[0],key:e[0],value:e[1]}}))},f=function(e){return"string"==typeof e?{queryType:c.metric,dimensions:l(e)}:e},p=n(3);function y(e){return"function"==typeof e}function d(e){return function(t){if(function(e){return y(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.create;function b(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function g(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e}Object.create;var j,O=((j=function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}((function(e){Error.call(e),e.stack=(new Error).stack}))).prototype=Object.create(Error.prototype),j.prototype.constructor=j,j);function w(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var x=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var a=b(i),u=a.next();!u.done;u=a.next()){u.value.remove(this)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(y(c))try{c()}catch(e){o=e instanceof O?e.errors:[e]}var s=this._teardowns;if(s){this._teardowns=null;try{for(var l=b(s),f=l.next();!f.done;f=l.next()){var p=f.value;try{S(p)}catch(e){o=null!=o?o:[],e instanceof O?o=g(g([],h(o)),h(e.errors)):o.push(e)}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(o)throw new O(o)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)S(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&w(t,e)},e.prototype.remove=function(t){var n=this._teardowns;n&&w(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();x.EMPTY;function S(e){y(e)?e():e.unsubscribe()}var A=null,E=null,_=!1,T=!1,C={setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=C.delegate;return((null==n?void 0:n.setTimeout)||setTimeout).apply(void 0,g([],h(e)))},clearTimeout:function(e){var t=C.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function P(e){C.setTimeout((function(){if(!A)throw e;A(e)}))}function M(){}var k=I("C",void 0,void 0);function I(e,t,n){return{kind:e,value:t,error:n}}var D=null;function F(e){_&&D&&(D.errorThrown=!0,D.error=e)}var R=function(e){function t(t){var n,r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,((n=t)instanceof x||n&&"closed"in n&&y(n.remove)&&y(n.add)&&y(n.unsubscribe))&&t.add(r)):r.destination=Q,r}return v(t,e),t.create=function(e,t,n){return new N(e,t,n)},t.prototype.next=function(e){this.isStopped?K(function(e){return I("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?K(I("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?K(k,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(x),N=function(e){function t(t,n,r){var o,i=e.call(this)||this;if(y(t))o=t;else if(t){var a;o=t.next,n=t.error,r=t.complete,i&&T?(a=Object.create(t)).unsubscribe=function(){return i.unsubscribe()}:a=t,o=null==o?void 0:o.bind(a),n=null==n?void 0:n.bind(a),r=null==r?void 0:r.bind(a)}return i.destination={next:o?q(o,i):M,error:q(null!=n?n:V,i),complete:r?q(r,i):M},i}return v(t,e),t}(R);function q(e,t){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{e.apply(void 0,g([],h(t)))}catch(e){_?F(e):P(e)}}}function V(e){throw e}function K(e,t){var n=E;n&&C.setTimeout((function(){return n(e,t)}))}var Q={closed:!0,next:M,error:V,complete:M},G=function(e){function t(t,n,r,o,i){var a=e.call(this,t)||this;return a.onFinalize=i,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=o?function(e){try{o(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return v(t,e),t.prototype.unsubscribe=function(){var t,n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))},t}(R);function L(e,t){return d((function(n,r){var o=0;n.subscribe(new G(r,(function(n){r.next(e.call(t,n,o++))})))}))}function U(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $(e){var t,n=e.refId+"/"+e.name+"/"+e.fields.length,o=U(e.fields);try{for(o.s();!(t=o.n()).done;){var i=t.value;n+="|"+i.name+":"+i.type,i.labels&&(n+=Object(r.formatLabels)(i.labels))}}catch(e){o.e(e)}finally{o.f()}return n}function J(e){return Object.assign(Object.assign({},e),{metricId:void 0,metrics:W(e)})}function W(e){return e.metrics?e.metrics:e.metricId?[{metricId:e.metricId}]:void 0}function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z(){return(Z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=ee(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function ee(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oe(e)););return e}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oe(e);if(t){var o=oe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return re(this,n)}}function re(e,t){if(t&&("object"===H(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&te(e,t)}(l,e);var t,n,a,s=ne(l);function l(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),s.call(this,e)}return t=l,(n=[{key:"query",value:function(e){var t,n,o=this;return t=e,n={getNextQueries:function(t){var n,r;if(null===(n=t.data)||void 0===n?void 0:n.length){var o,i=[],a=X(t.data);try{var u=function(){var t=o.value,n=null===(r=t.meta)||void 0===r?void 0:r.custom;if(n&&n.nextToken){var a=e.targets.find((function(e){return e.refId===t.refId}));a&&i.push(Object.assign(Object.assign({},a),{nextToken:n.nextToken}))}};for(a.s();!(o=a.n()).done;)u()}catch(e){a.e(e)}finally{a.f()}if(i.length)return i}},query:function(e){return Z(oe(l.prototype),"query",o).call(o,e)},process:function(e,t,n){return e.data?e.data=function(e,t){var n,o=new Map,i=[],a=U(e);try{for(a.s();!(n=a.n()).done;){var u=n.value;if(u.length){var c=$(u);if(u instanceof r.MutableDataFrame)o.set(c,u),i.push(u);else{var s=new r.MutableDataFrame;s.meta=u.meta,s.name=u.name,s.refId=u.refId;var l,f=U(u.fields);try{for(f.s();!(l=f.n()).done;){for(var p=l.value,y=[],d=0;d<u.length;d++)y.push(p.values.get(d));s.addField(Object.assign(Object.assign({},p),{values:new r.ArrayVector(y)}))}}catch(e){f.e(e)}finally{f.f()}o.set(c,s),i.push(s)}}}}catch(e){a.e(e)}finally{a.f()}var m,v=U(t);try{for(v.s();!(m=v.n()).done;){var b=m.value;if(b.length){var h=$(b),g=o.get(h);if(g)for(var j=0;j<b.length;j++)for(var O=0;O<g.fields.length;O++)g.fields[O].values.add(b.fields[O].values.get(j));else i.push(b)}}}catch(e){v.e(e)}finally{v.f()}return i}(e.data,t):e.data=t,e.data},onCancel:function(e){}},new p.Observable((function(e){var o=void 0,i=void 0,a={fetchStartTime:Date.now(),fetchEndTime:void 0},u=r.LoadingState.Loading,c=1,s={next:function(i){a.fetchEndTime=Date.now(),(u=i.state)!==r.LoadingState.Error&&(o=n.getNextQueries(i),u=o?r.LoadingState.Streaming:r.LoadingState.Done);var c=n.process(a,i.data,!o);e.next(Object.assign(Object.assign({},i),{data:c,state:u,key:t.requestId}))},error:function(t){e.error(t)},complete:function(){i&&(i.unsubscribe(),i=void 0),o?(a.fetchEndTime=void 0,a.fetchStartTime=Date.now(),i=n.query(Object.assign(Object.assign({},t),{requestId:"".concat(t.requestId,".").concat(++c),startTime:a.fetchStartTime,targets:o})).subscribe(s),o=void 0):e.complete()}};return i=n.query(t).subscribe(s),function(){o=void 0,s.complete(),a.fetchEndTime||n.onCancel(a)}}))}},{key:"filterQuery",value:function(e){if(e.hide)return!1;if(!e.queryType)return!1;if((t=e.queryType)!==i.GetMetricValue&&t!==i.GetMetricHistory&&t!==i.GetMetricAggregate)return!0;var t,n=W(e);return void 0!==n&&n.length>0}},{key:"formatMetric",value:function(e){return e.metricId||""}},{key:"formatDimension",value:function(e){return"".concat(e.key,"=").concat(e.value)}},{key:"getQueryDisplayText",value:function(e){var t,n,r="["+(null===(t=e.dimensions)||void 0===t?void 0:t.map(this.formatDimension).join(","))+"]";return e.metrics&&(null===(n=e.metrics)||void 0===n?void 0:n.length)>0&&(r+=" "+e.metrics.map(this.formatMetric).join("&")),r||e.refId}},{key:"metricFindQuery",value:function(e,t){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=f(e)).queryType!==c.dimensionValue){t.next=8;break}if(n.dimensionKey){t.next=4;break}return t.abrupt("return",[]);case 4:return t.next=6,this.listDimensionsValues(n.dimensionKey,"",[]);case 6:return r=t.sent,t.abrupt("return",r.map((function(e){return{text:e.value||""}})));case 8:return o=this.listMetrics(n.dimensions,"").pipe(L((function(e){return e.map((function(e){return{text:e.value||""}}))}))),t.abrupt("return",Object(p.lastValueFrom)(o));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"applyTemplateVariables",value:function(e,t){var n,r,o=Object(u.getTemplateSrv)(),i=J(e),a=null===(n=i.metrics)||void 0===n?void 0:n.flatMap((function(e){var n=o.replace(e.metricId,t,"json");try{return JSON.parse(n)}catch(e){return[n]}})).flat().map((function(e){return{metricId:e}})),c=null===(r=i.dimensions)||void 0===r?void 0:r.map((function(e){return Object.assign(Object.assign({},e),{value:o.replace(e.value,t)})}));return Object.assign(Object.assign({},i),{dimensions:c,metrics:a||[]})}},{key:"runQuery",value:function(e,t){return this.query({targets:[e],requestId:"iot.".concat(ae++),maxDataPoints:t})}},{key:"listDimensionKeys",value:function(e,t){return o(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o={refId:"listDimensionKeys",queryType:i.ListDimensionKeys,selected_dimensions:t,filter:e},a=this.runQuery(o).pipe(L((function(e){if(e.data.length)return new r.DataFrameView(e.data[0]).toArray();throw"no dimensions found ".concat(e.error)}))),n.abrupt("return",Object(p.lastValueFrom)(a));case 3:case"end":return n.stop()}}),n,this)})))}},{key:"listDimensionsValues",value:function(e,t,n){return o(this,void 0,void 0,regeneratorRuntime.mark((function o(){var a,u;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return a={refId:"listDimensionsValues",queryType:i.ListDimensionValues,dimensionKey:e,selected_dimensions:n,filter:t},u=this.runQuery(a).pipe(L((function(e){if(e.data.length)return new r.DataFrameView(e.data[0]).toArray();throw"no dimension values found"}))),o.abrupt("return",Object(p.lastValueFrom)(u));case 3:case"end":return o.stop()}}),o,this)})))}},{key:"listMetrics",value:function(e,t){var n={refId:"listMetrics",queryType:i.ListMetrics,dimensions:e,filter:t};return this.runQuery(n).pipe(L((function(e){if(e.data.length)return new r.DataFrameView(e.data[0]).toArray();throw"no metrics found"})))}}])&&Y(t.prototype,n),a&&Y(t,a),Object.defineProperty(t,"prototype",{writable:!1}),l}(u.DataSourceWithBackend),ae=1e3,ue=n(0),ce=n.n(ue),se=n(2);function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ve(e);if(t){var o=ve(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return me(this,n)}}function me(e,t){if(t&&("object"===le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var be=se.LegacyForms.SecretFormField,he=se.LegacyForms.FormField,ge=se.LegacyForms.Switch,je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ye(e,t)}(i,e);var t,n,r,o=de(i);function i(){var e;return fe(this,i),(e=o.apply(this,arguments)).onEndpointChange=function(t){var n=e.props,r=n.onOptionsChange,o=n.options,i=Object.assign(Object.assign({},o.jsonData),{endpoint:t.target.value});r(Object.assign(Object.assign({},o),{jsonData:i}))},e.onAPIKeyChange=function(t){var n=e.props,r=n.onOptionsChange,o=n.options;r(Object.assign(Object.assign({},o),{secureJsonData:{apiKey:t.target.value}}))},e.onResetAPIKey=function(){var t=e.props,n=t.onOptionsChange,r=t.options;n(Object.assign(Object.assign({},r),{secureJsonFields:Object.assign(Object.assign({},r.secureJsonFields),{apiKey:!1}),secureJsonData:Object.assign(Object.assign({},r.secureJsonData),{apiKey:""})}))},e.toggleAuth=function(){var t=e.props,n=t.onOptionsChange,r=t.options,o=Object.assign(Object.assign({},r.jsonData),{apikey_authentication_enabled:!r.jsonData.apikey_authentication_enabled});n(Object.assign(Object.assign({},r),{jsonData:o}))},e}return t=i,(n=[{key:"render",value:function(){var e=this.props.options,t=e.jsonData,n=e.secureJsonFields,r=e.secureJsonData||{};return ce.a.createElement("div",{className:"gf-form-group"},ce.a.createElement(ce.a.Fragment,null,ce.a.createElement("h3",{className:"page-heading"},"Backend"),ce.a.createElement("div",{className:"gf-form-group"},ce.a.createElement("div",{className:"gf-form"},ce.a.createElement(he,{label:"Endpoint",labelWidth:6,inputWidth:20,onChange:this.onEndpointChange,value:t.endpoint||"",placeholder:"endpoint of the grpc server",tooltip:"Specify a complete HTTP URL (for example grpc.example.com:443)"}))),ce.a.createElement("h3",{className:"page-heading"},"Auth"),ce.a.createElement(ge,{onChange:this.toggleAuth,label:"API Key Authentication",key:"test key",checked:t.apikey_authentication_enabled}),ce.a.createElement("div",{className:"gf-form-group",hidden:!t.apikey_authentication_enabled},ce.a.createElement("div",{className:"gf-form"},ce.a.createElement(be,{isConfigured:n&&n.apiKey,value:r.apiKey||"",label:"API Key",placeholder:"secure json field (backend only)",labelWidth:6,inputWidth:20,onReset:this.onResetAPIKey,onChange:this.onAPIKeyChange})))))}}])&&pe(t.prototype,n),r&&pe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(ue.PureComponent),Oe=n(19),we=n.n(Oe),xe=[{label:"Get metric history",value:i.GetMetricHistory,description:"Gets the history of a metric.",defaultQuery:{}},{label:"Get metric value",value:i.GetMetricValue,description:"Gets a metrics current value.",defaultQuery:{}},{label:"Get metric aggregate",value:i.GetMetricAggregate,description:"Gets a metrics aggregate value.",defaultQuery:{aggregateType:a.AVERAGE}}];var Se=n(20),Ae=n.n(Se);function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te=function(e){var t=e.dimension,n=e.loadDimensions,r=e.loadDimensionValues,o=e.onChange,i=e.onRemove,a=Ee(Object(ue.useState)(t),2),u=a[0],c=a[1],s=function(e){l(Object.assign(Object.assign({},u),{value:e||""}))},l=function(e){c(e),o(e)};return ce.a.createElement("div",{className:"gf-form"},ce.a.createElement(ce.a.Fragment,null,ce.a.createElement("label",{className:"gf-form-label width-10"},"Key"),ce.a.createElement(se.AsyncSelect,{defaultOptions:!0,value:{label:t.key,value:t.key},cacheOptions:!1,loadOptions:n,onChange:function(e){return t=e.value,void l(Object.assign(Object.assign({},u),{key:t||""}));var t}})),ce.a.createElement(ce.a.Fragment,null,ce.a.createElement("span",{className:"gf-form-label width-10"},"Value"),ce.a.createElement(se.AsyncSelect,{key:t.key,defaultOptions:!0,value:{label:t.value,value:t.value},loadOptions:function(e){return r(t.key,e)},isSearchable:!0,isClearable:!0,allowCustomValue:!0,onCreateOption:s,onChange:function(e){return s(null==e?void 0:e.value)}})),ce.a.createElement(se.Button,{variant:"secondary",onClick:function(e){return i(t)}},ce.a.createElement(se.Icon,{name:"trash-alt"})))};function Ce(e){return function(e){if(Array.isArray(e))return ke(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Me(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}(e,t)||Me(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(e,t){if(e){if("string"==typeof e)return ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ke(e,t):void 0}}function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ie=function(e){var t=e.initState,n=e.onChange,r=e.datasource,o=Pe(Object(ue.useState)(t),2),i=o[0],a=o[1],u=function(e){a(e),n(e)},c=function(e){u([].concat(Ce(i.filter((function(t){return t.id!==e.id}))),[e]))},s=function(e){u(i.filter((function(t){return t.id!==e.id})))},l=function(e){return r.listDimensionKeys(e,i)},f=function(e,t){return r.listDimensionsValues(e,t,i)};return ce.a.createElement(ce.a.Fragment,null,ce.a.createElement("div",null,i.map((function(e,t){return ce.a.createElement(Te,{key:e.id,dimension:e,onChange:c,onRemove:s,loadDimensions:l,loadDimensionValues:f})}))),ce.a.createElement("div",{className:"gf-form"},ce.a.createElement(se.Button,{variant:"secondary",icon:"plus",onClick:function(){var e={id:Ae()(),key:"",value:"",configured:!1};u([].concat(Ce(i),[e]))}},"Add dimension")))};function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ve(e);if(t){var o=Ve(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qe(this,n)}}function qe(e,t){if(t&&("object"===De(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ke=se.LegacyForms.Select,Qe=se.LegacyForms.FormField,Ge=new r.Registry((function(){return[{id:a.AVERAGE,name:"Average"},{id:a.COUNT,name:"Count"},{id:a.MAXIMUM,name:"Max"},{id:a.MINIMUM,name:"Min"}]})),Le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Re(e,t)}(a,e);var t,n,r,o=Ne(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).onQueryTypeChange=function(e){var n,r,o=t.props,i=o.onChange,a=o.query,u=o.onRunQuery;i((r=e,(n=a).queryType===r.value?n:Object.assign(Object.assign(Object.assign({},r.defaultQuery),n),{queryType:r.value}))),u()},t.onAggregateChange=function(e){var n=t.props,r=n.onChange,o=n.query,i=n.onRunQuery;r(Object.assign(Object.assign({},o),{aggregateType:e&&e.value})),i()},t.onDisplayNameChange=function(e){var n=t.props,r=n.onChange,o=n.query,i=n.onRunQuery;r(Object.assign(Object.assign({},o),{displayName:e&&e.target.value})),i()},t.onDimensionsChange=function(e){var n=t.props,r=n.onChange,o=n.query,i=n.onRunQuery;r(Object.assign(Object.assign({},o),{dimensions:e})),i()},t.loadMetrics=function(e){var n=t.props.datasource,r=t.props.query.dimensions;return Object(p.lastValueFrom)(n.listMetrics(r||[],e))},t.displayNameFields=function(e){return null==e?void 0:e.map((function(e){return e.key})).concat(["metric","aggregate"]).map((function(e){return"{{"+e+"}}"})).join()},t}return t=a,(n=[{key:"onMetricChange",value:function(e){var t=this.props,n=t.onChange,r=t.query,o=t.onRunQuery,i=e.map((function(e){return{metricId:e.value}}));n(Object.assign(Object.assign({},r),{metrics:i})),o()}},{key:"onAddMetric",value:function(e){if(e){var t=this.props,n=t.onChange,r=t.query,o=t.onRunQuery,i=r.metrics;n(Object.assign(Object.assign({},r),{metrics:(null==i?void 0:i.concat({metricId:e}))||[{metricId:e}]})),o()}}},{key:"render",value:function(){var e,t,n=this,r=J(we()(this.props.query,s)),o=xe.find((function(e){return e.value===r.queryType})),a=Ge.selectOptions([r.aggregateType||""]),u=null===(e=this.props.query.dimensions)||void 0===e?void 0:e.map((function(e){return e.key+e.value})).join(),c=null===(t=r.metrics)||void 0===t?void 0:t.map((function(e){return{label:e.metricId,value:e.metricId}}));return ce.a.createElement("div",{className:"gf-form-group"},ce.a.createElement(ce.a.Fragment,null,ce.a.createElement("div",{className:"gf-form"},ce.a.createElement("label",{className:"gf-form-label width-10"},"Query Type"),ce.a.createElement(Ke,{options:xe,value:o,onChange:this.onQueryTypeChange,placeholder:"Select query type",menuPlacement:"bottom"})),ce.a.createElement(Ie,{initState:r.dimensions||[],datasource:this.props.datasource,onChange:this.onDimensionsChange}),ce.a.createElement(ce.a.Fragment,null,ce.a.createElement("div",{className:"gf-form"},ce.a.createElement("label",{className:"gf-form-label width-10"},"Metric"),ce.a.createElement(se.AsyncMultiSelect,{key:u,defaultOptions:!0,value:c,loadOptions:this.loadMetrics,onChange:function(e){return n.onMetricChange(e)},onCreateOption:function(e){return n.onAddMetric(e)},allowCustomValue:!0,isSearchable:!0,isClearable:!0})),ce.a.createElement("div",{className:"gf-form",hidden:!o||o.value!==i.GetMetricAggregate},ce.a.createElement("label",{className:"gf-form-label width-10"},"Aggregate"),ce.a.createElement(Ke,{value:a.current,options:a.options,onChange:this.onAggregateChange}))),ce.a.createElement(ce.a.Fragment,null,ce.a.createElement(Qe,{labelWidth:10,value:r.displayName,onChange:this.onDisplayNameChange,label:"Display Name",type:"text",tooltip:"use ".concat(this.displayNameFields(r.dimensions)," for dynamic expressions")}))))}}])&&Fe(t.prototype,n),r&&Fe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(ue.PureComponent);function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $e=function(e){var t=e.datasource,n=e.onChange,r=f(e.query),o=Ue(Object(ue.useState)(r),2),i=o[0],a=o[1],u=function(e){switch(e.queryType){case c.metric:return e.dimensions.map((function(e){return"".concat(e.key,"=").concat(e.value)})).join(";");case c.dimensionValue:return"dimension=".concat(e.dimensionKey)}},s=function(e){var t=Object.assign(Object.assign({},i),{queryType:e||c.metric});a(t),n(t,u(t))},l=function(e){var t=Object.assign(Object.assign({},i),{dimensionKey:e||""});a(t),n(t,u(t))},p=[{value:c.metric,label:"Metric",description:"the query selects metrics"},{value:c.dimensionValue,label:"DimensionValue",description:"the query selects dimension values"}];return ce.a.createElement(ce.a.Fragment,null,ce.a.createElement("div",{className:"gf-form"},ce.a.createElement("label",{className:"gf-form-label width-10"},"Query Type"),ce.a.createElement(se.Select,{onChange:function(e){return s(e.value)},options:p,value:r.queryType})),i.queryType===c.metric&&ce.a.createElement(Ie,{initState:i.dimensions,onChange:function(e){var t=Object.assign(Object.assign({},i),{dimensions:e});a(t),n(t,u(t))},datasource:t}),i.queryType===c.dimensionValue&&ce.a.createElement(ce.a.Fragment,null,ce.a.createElement("div",{className:"gf-form"},ce.a.createElement("label",{className:"gf-form-label width-10"},"Dimension Key"),ce.a.createElement(se.AsyncSelect,{defaultOptions:!0,value:{label:r.dimensionKey,value:r.dimensionKey},cacheOptions:!1,loadOptions:function(e){return t.listDimensionKeys(e,[])},onChange:function(e){return l(e.value)}}))))};n.d(t,"plugin",(function(){return Je}));var Je=new r.DataSourcePlugin(ie).setConfigEditor(je).setVariableQueryEditor($e).setQueryEditor(Le)}])}));
//# sourceMappingURL=module.js.map